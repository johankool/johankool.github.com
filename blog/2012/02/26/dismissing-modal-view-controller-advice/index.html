
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dismissing Modal View Controller Advice - Koolistov</title>
  <meta name="author" content="Johan Kool">

  
  <meta name="description" content="Earlier today Mugunth Kumar blogged about some advice about dismissing modal view controllers to further explain his tweets from Saturday: &#8220;The &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://koolistov.net/blog/2012/02/26/dismissing-modal-view-controller-advice">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Koolistov" type="application/atom+xml">
  <link href="/apple-touch-icon.png" rel="apple-touch-icon" />
<!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Cabin+Sketch:700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Coming+Soon' rel='stylesheet' type='text/css'>
<!-- Google Webmasters tool -->
<meta name="google-site-verification" content="aQXE9vCD3QjNp7xGnUKCTLwPJBJ1cdr6bPVO2pOro6I" />
<meta name="google-site-verification" content="aN8hIjVAB2gp1sImatDmi7gZkHBTSUAH9Hd6whpackk" />
<meta name="google-site-verification" content="Fdgqd5dr_QcBpDw7KhTvPaqhwnVfSyGiQcSB4uYyod8" />

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-285308-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Koolistov</a></h1>
  
    <h2>-- where apps are made</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:koolistov.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/products/">Products</a></li>
  <li><a href="/services/">Services</a></li>
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/contact/">Contact</a></li>
  <!-- <li><a href="/blog/archives/">Archives</a></li> -->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Dismissing Modal View Controller Advice</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-26T21:00:00+08:00" pubdate data-updated="true">Feb 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Earlier today <a href="http://twitter.com/mugunthkumar/">Mugunth Kumar</a> blogged about <a href="http://blog.mugunthkumar.com/articles/ownership-of-presented-view-controllers-with-and-without-arc/">some advice about dismissing modal view controllers</a> to further explain his tweets from Saturday:</p>

<blockquote><p>&#8220;The controller that presents a modal controller should dismiss it. Don&#8217;t do [self dismissModalViewControllerAnimated:NO] in the child.&#8221;</p></blockquote>


<p>and:</p>

<blockquote><p>&#8220;Calling [self dismissModalViewControllerAnimated:NO] on child is like committing seppuku. A child shouldn&#8217;t kill itself.&#8221;</p></blockquote>


<p>He does have a good point saying the presenting view controller should also be the one deciding when the modal view controller should disappear. However, it is not too far fetched to say that the modal view controller itself can determine best when its time has come.</p>

<!--more-->


<p>I am uncertain wether we can deduct from Apple&#8217;s sample code and/or API which approach they recommend. Even if all sample code lets the presenting view controller decide (I haven&#8217;t checked this), the API clearly allows the modal view controller to dismiss itself.</p>

<p>My biggest objection though arises as he next attempts to explain that under ARC it is not possible to have proper memory management simultaneously with letting the modal view controller dismiss itself. This is just false.</p>

<p>In his non-ARC examples in both cases he retains the modal view controller before presenting it. This may be useful on occasion, but there is no need for it. The modal view controller is namely already retained when the <code>-[presentModalViewController:animated:]</code> method gets called. It is perfectly valid to pass an autoreleased view controller to that method. That would also avoid the ugly memory management that he uses in his second method. (There is BTW also a memory leak when he assigns the modal view controller to its property.) On <code>-[dismissModalViewControllerAnimated:]</code> the modal view controller gets released again.</p>

<p>There is nothing in this that changes under ARC vs. non-ARC. In both cases this works fine, wether you let the presenting or the modal view controller dismiss doesn&#8217;t matter. So this only leaves the &#8216;purity&#8217; of which way is cleaner. That is a debatable issue.</p>

<p>So, I&#8217;d conclude, feel free to do it in the way that makes sense to you. Keep an eye on your memory management, also with ARC, but either way can work.</p>

<p><strong>Update:</strong> <a href="http://twitter.com/mugunthkumar/">Mugunth Kumar</a>:</p>

<blockquote><p>&#8220;@johankool Good, but you still haven&#8217;t shown a ARC example.&#8221;</p></blockquote>


<p>Okay, fair enough. The below is a sample of how I would do this with ARC. As I said, there doesn&#8217;t really change anything in ARC vs. non-ARC.</p>

<figure class='code'><figcaption><span>Presenting View Controller  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">showModalViewController</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">SomeViewController</span> <span class="o">*</span><span class="n">someViewController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">SomeViewController</span><span class="p">]</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithNibName:</span><span class="s">@&quot;SomeViewController&quot;</span> <span class="nl">bundle:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="cp">    // Note: under non-ARC I would call autorelease on someViewController</span>
</span><span class='line'><span class="cp">#if DELEGATE</span>
</span><span class='line'>    <span class="n">someViewController</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>
</span><span class='line'><span class="cp">#elif COMPLETION_BLOCK</span>
</span><span class='line'>    <span class="n">someViewController</span><span class="p">.</span><span class="n">completionBlock</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">NSUInteger</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">self</span><span class="p">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'>        <span class="c1">// Note: there isn&#39;t really any need to reference someViewController in this block</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span> <span class="nl">presentModalViewController:</span><span class="n">someViewController</span> <span class="nl">animated:</span><span class="n">YES</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#if DELEGATE</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">someViewController:</span><span class="p">(</span><span class="n">SomeViewController</span> <span class="o">*</span><span class="p">)</span><span class="n">controller</span> <span class="nl">pickedResult:</span><span class="p">(</span><span class="n">NSUInteger</span><span class="p">)</span><span class="n">result</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">self</span><span class="p">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">#endif</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Modal View Controller  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">pickedResult:</span><span class="p">(</span><span class="n">NSUInteger</span><span class="p">)</span><span class="n">result</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#if DELEGATE</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">delegate</span> <span class="nl">someViewController:</span><span class="n">self</span> <span class="nl">pickedResult:</span><span class="n">result</span><span class="p">];</span>
</span><span class='line'><span class="cp">#elif COMPLETION_BLOCK</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">completionBlock</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">self</span><span class="p">.</span><span class="n">completionBlock</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span> <span class="nl">dismissModalViewControllerAnimated:</span><span class="n">YES</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Johan Kool</span></span>

      








  


<time datetime="2012-02-26T21:00:00+08:00" pubdate data-updated="true">Feb 26<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cocoa/'>Cocoa</a>, <a class='category' href='/blog/categories/objective-c/'>Objective-C</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/02/04/why-ios-apps-crash/" title="Previous Post: Why iOS Apps Crash">&laquo; Why iOS Apps Crash</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/02/26/setting-compiler-flags-on-multiple-files/" title="next Post: Setting Compiler Flags on Multiple Files">Setting Compiler Flags on Multiple Files &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/02/26/setting-compiler-flags-on-multiple-files/">Setting Compiler Flags on Multiple Files</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/26/dismissing-modal-view-controller-advice/">Dismissing Modal View Controller Advice</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/04/why-ios-apps-crash/">Why iOS Apps Crash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/01/big-promotion/">Big Promotion</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/19/rtlnieuws-365-is-a-go/">RTLNieuws 365 is a Go!</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/Koolistov">@Koolistov</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Koolistov',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Stack Overflow</h1>
  <br />
  <a href="http://stackoverflow.com/users/60488/johan-kool"><img src="http://stackoverflow.com/users/flair/60488.png?theme=clean" width="208" height="58" alt="profile for Johan Kool at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Johan Kool at Stack Overflow, Q&amp;A for professional and enthusiast programmers"></a>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("johankool", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/johankool" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @johankool</a>
  
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Koolistov Pte. Ltd. - <a href="/generalconditions/">Terms &amp; Conditions</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'koolistov';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://koolistov.net/blog/2012/02/26/dismissing-modal-view-controller-advice/';
        var disqus_url = 'http://koolistov.net/blog/2012/02/26/dismissing-modal-view-controller-advice/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
